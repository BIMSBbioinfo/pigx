#!@RSCRIPT@

# Title     : test_deconvolution
# Objective : 
# Created by: vfs
# Created on: 23.06.21

srcdir <- Sys.getenv("srcdir")
source(file.path(srcdir,"scripts/deconvolution.R"))

# test building of simple signature matrix
# test_inputs
match.df <- read.table(file.path(srcdir,"sample_data/test_match.df") , sep = ",", header = TRUE)
muts <- c(match.df$AA_mut)
sig_mutations.df <- read.table( file.path(srcdir,"sample_data/test_sig_mutations.df"), sep = ",", header = TRUE)
# run function
sig_matrix_observed <- createSigMatrix( muts, sig_mutations.df )
# check for expected structure
all ( # check if first column contains only character
      is.character(class(sig_matrix_observed$muts)) && 
      # check if values are only 1 or 0  
      all ( sapply(sig_matrix_observed[, - which( names(sig_matrix_observed) == "muts")], 
           function(x) is.numeric(x) && all(x %in% c(0,1))) )
)